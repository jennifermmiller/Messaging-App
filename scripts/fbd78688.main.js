function clearModal(){$("#modal input").each(function(){$(this).val("")})}function loadPage(){$(".left-side").show(),$(".message-stream-plus-header").show(),$(".footer").show(),new UserView,messages.fetch({success:function(){messages.sort(),messages.each(function(a){console.log(messages),new ListView({model:a})})}}),$("#start-app").hide(),$("#logout-btn").show()}function getMessages(){messages.fetch({success:function(){messages.each(function(a){console.log(messages),new ListView({model:a})})},error:function(){console.log("Just kidding! You cant fetch this stuff")}})}var MessageClass=Parse.Object.extend("MessageClass"),MessagesCollection=Parse.Collection.extend({model:MessageClass,comparator:function(a){return a.get("createdAt")}}),LoginView=Parse.View.extend({createTemplate:_.template($("#login-template").text()),events:{"click #signup-btn":"signUpUser","click #login-btn":"logInUser"},initialize:function(){$("body").append(this.el),this.render()},render:function(){this.$el.html(this.createTemplate())},signUpUser:function(){var a=new Parse.User,b=$("#user-name").val(),c=$("#user-pswd").val(),d=$("#user-email").val(),e=$("#user-avatar")[0];if(e.files.length>0)var f=e.files[0],g="photo.jpg",h=new Parse.File(g,f);h.save().then(function(){a.set("avatar",h),console.log("Yay! Your avatar has been saved!")}),a.set("username",b),a.set("password",c),a.set("email",d),a.signUp(null,{success:function(){currentUser=Parse.User.current(),clearModal(),loadPage()},error:function(a,b){console.log("Oopz! We could not sign you up!"+b)}})},logInUser:function(){var a=$("#returning-user-name").val(),b=$("#returning-user-pswd").val();Parse.User.logIn(a,b,{success:function(){currentUser=Parse.User.current(),loadPage(),clearModal(),$(this).hide(),$("#logout-btn").show(),console.log(currentUser)},error:function(a,b){console.log("Oopz! You could not be logged in!"+b)}})}}),UserView=Parse.View.extend({events:{"click #send-btn":"sendMsg"},template:_.template($("#user-template").text()),initialize:function(){$(".user-info").html(this.el),this.render()},render:function(){var a=this.template();this.$el.html(a)},sendMsg:function(){console.log("here?");var a=new MessageClass,b=$("#message-data").val(),c=currentUser.get("username"),d=moment().format("MMM Do YY, h:mm a");a.set("author",c),a.set("time",d),a.set("messageContents",b),messages.add(a),a.save(null,{successs:function(){console.log("Sweet! Message saved!")},error:function(a,b){console.log(b.description)}}),$("#message-data").val("")}}),ListView=Parse.View.extend({className:"message-row",events:{dblclick:"expand"},template:_.template($("#list-template").text()),initialize:function(){$(".message-stream").prepend(this.el),this.render()},render:function(){var a=this.template({model:this.model});this.$el.html(a)},expand:function(){this.$el.toggleClass("expand")}});console.log("'Allo 'Allo!"),$(document).ready(function(){Parse.initialize("fTnob4g9ivFWWMunx5p5tq2X2Fp4U6T56uTzd96n","tMj1YBzrbJ4IIxCj72j7JVXy0VOVrFHJ6z9h7m4m"),window.messages=new MessagesCollection,$("#start-app").click(function(){console.log("huh?"),new LoginView}),$("#logout-btn").click(function(){Parse.User.logOut(),currentUser=Parse.User.current(),$(".left-side").hide(),$(".message-stream-plus-header").empty().hide(),$(this).hide(),$("#start-app").show()})});